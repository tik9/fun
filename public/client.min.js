
var container = document.getElementById('container')
var dateformat = /^\d{4}-\d{2}-\d{2}/

var tiko = "Tiko's"
document.title += tiko;

var gih = 'https://github.com'
var ghMe = gih + '/tik9/fun'
var ghBase = ghMe + '/blob/master'

var ghUlLinks = document.createElement('ul')
ghUlLinks.style.marginBottom = '70px'
var topnav = document.getElementById('topnav')
topnav.id = 'topnav'
topnav.classList.add('fixed-top', 'bg-dark')

create_icon()
css()
navbottom()

function create_icon() {
    var icon = document.createElement("link");
    icon.rel = "icon";
    icon.href = gih + "/github.png";
    document.head.appendChild(icon);
}

async function css() {
    var mincss = '.min.css'
    var obj = help_includes()
    // console.log(obj.cdn)
    var css_arr = await css_js([obj.cdn + obj.boots + 'css/bootstrap' + mincss], 'css')

    for (var elem of css_arr) {
        var link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = elem;
        document.head.appendChild(link);
    }
}

async function css_js(arr, type) {
    var res = await (await fetch('/.netlify/functions/file?dir=' + type)).json()
    arr.push(...res.map(str => (type + '/' + str)))
    return arr
}

function git_code(js_arr2) {
    for (var elem of js_arr2) {
        var li = document.createElement("li");
        var aref = document.createElement("a");
        li.appendChild(aref);
        aref.href = ghBase + '/' + elem
        aref.textContent = elem.split('/')[1];
        ghUlLinks.append(li);
    }
    var ghDivLink = document.getElementById("git_code");
    ghDivLink.classList.add('mt-5', 'mb-5')
    ghDivLink.append(ghUlLinks);
}

function help_includes() {
    var obj = {
        cdn: 'https://cdnjs.cloudflare.com/ajax/libs/',
        boots: 'twitter-bootstrap/5.0.0/'
    }
    return obj
}


function list(arr) {
    var ul = document.createElement('ul')
    for (var elem in arr) {
        var val = arr[elem]
        val = dateformat.test(val) ? locale_date(val) : val

        var li = document.createElement('li')
        li.appendChild(document.createTextNode(`${elem.replace('_', ' ')}: ${val}`))
        ul.appendChild(li)
    }
    return ul
}

function navbottom() {
    var aref = document.createElement("a");
    bottomnav.classList.add('fixed-bottom', 'bg-dark')
    aref.textContent = tiko;
    aref.href = '/'
    aref.classList.add('active', 'nav')
    bottomnav.append(aref)
    for (var elem of ["contact", 'imprint']) {
        var aref = document.createElement("a");
        aref.href = `${elem}.html`;
        aref.textContent = elem[0].toUpperCase() + elem.slice(1)
        aref.classList.add('nav')

        bottomnav.append(aref)
    }
}